<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>legend 图例</title>
  <meta name="keywords" content="G2, The Grammar of Graphics, 图形语法,图表绘制引擎,图表库,可视化,数据可视化,AntV,Data Visualization,visualization,visualisation, antd, ant, ant design, G6, 流程图, 关系图, 可视化规范, 地图, 河流图, 力导图, 网络图, UML图, 流图, 时序图, 图">
  <meta name="description" content="一套专业、简单、无限可能的可视化解决方案">
  <link rel="icon" href="https://zos.alipayobjects.com/rmsportal/oNtwPuEICFyCWUHztcOA.png" type="image/x-icon">
  <link rel="shortcut icon" href="https://zos.alipayobjects.com/rmsportal/oNtwPuEICFyCWUHztcOA.png" type="image/x-icon">
  <link rel="stylesheet" type="text/css" href="../../../../static/style.css" />
  <link rel="stylesheet" type="text/css" href="../../../../static/codemirror.css" />
  <link rel="stylesheet" type="text/css" href="../../../../static/tipuesearch/tipuesearch.css" >
  <script src="../../../../static/jquery.js"></script>
  <script src="../../../../static/tipuesearch/tipuesearch_set.js"></script>
  <script src="../../../../static/tipuesearch/tipuesearch.js"></script>
  <script src="https://g.alicdn.com/bui/??seajs/2.3.0/sea.js"></script>
  <script src="https://g.alicdn.com/bui/bui/1.1.17/config.js"></script>
  <script src="../../../../static/script.js"></script>
<script src="https://gw.alipayobjects.com/as/g/datavis/g2/2.3.13/index.js"></script>
</head>
<body><header id="header">
  <div class="nav-wrapper gradient-line">
    <div class="nav-content clearfix">
      <div class="pull-left">
        <a href="/index.html" class="nav-logo">
          <img src="https://zos.alipayobjects.com/rmsportal/aGpKpuxoGfZqJobMPLvj.svg">
          <span class="logo-text">AntV</span>
        </a>
        <div class="search-box">
          <form action="/search.html">
            <i class="iconfont icon-search"></i>
            <input type="text" name="q" id="tipue_search_input" autocomplete="off" required>
          </form>
        </div>
      </div>
      <div class="nav pull-right">
        <ul id="J_nav" class="clearfix nav-list">
          <li id="g2" class="nav-item hover">
            <a class="nav-item-link" href="/g2/doc/index.html">G2</a>
            <ul class="nav-sub-list fadeUp">
              <li class="nav-sub-item"><a href="/g2/doc/index.html">快速上手</a></li>
              <li class="nav-sub-item"><a href="/g2/doc/tutorial/start/index.html">使用教程</a></li>
              <li class="nav-sub-item"><a href="/g2/demo/index.html">图表示例</a></li>
              <li class="nav-sub-item"><a href="/g2/api/index.html">API</a></li>
              <li class="nav-sub-item"><a href="/g2/doc/history.html">更新日志</a></li>
            </ul>
          </li>
          <li id="g2-mobile" class="nav-item">
            <a class="nav-item-link" href="/g2-mobile/doc/index.html">G2-mobile</a>
            <ul class="nav-sub-list fadeUp">
              <li class="nav-sub-item"><a href="/g2-mobile/doc/index.html">快速上手</a></li>
              <li class="nav-sub-item"><a href="/g2-mobile/doc/tutorial/shape.html">使用教程</a></li>
              <li class="nav-sub-item"><a href="/g2-mobile/demo/index.html">图表示例</a></li>
              <li class="nav-sub-item"><a href="/g2-mobile/api/index.html">API</a></li>
              <li class="nav-sub-item"><a href="/g2-mobile/doc/history.html">更新日志</a></li>
            </ul>
          </li>
          <li id="g6" class="nav-item">
            <a class="nav-item-link" href="/g6/doc/index.html">G6</a>
            <ul class="nav-sub-list fadeUp">
              <li class="nav-sub-item"><a href="/g6/doc/index.html">快速上手</a></li>
              <li class="nav-sub-item"><a href="/g6/doc/tutorial/start/base.html">使用教程</a></li>
              <li class="nav-sub-item"><a href="/g6/demo/index.html">图表示例</a></li>
              <li class="nav-sub-item"><a href="/g6/api/index.html">API</a></li>
              <li class="nav-sub-item"><a href="/g6/doc/history.html">更新日志</a></li>
              <li class="nav-sub-item"><a href="/g6/tools/index.html" target="_blank">在线工具</a></li>
            </ul>
          </li>
          <li id="vis" class="nav-item last">
            <a class="nav-item-link" href="/vis/doc/chart/index.html">可视化基础</a>
            <ul class="nav-sub-list fadeUp">
              <li class="nav-sub-item"><a href="/vis/doc/chart/classify/compare.html">图表用法</a></li>
              <li class="nav-sub-item"><a href="/vis/doc/design/index.html">图表设计指引</a></li>
              <li class="nav-sub-item"><a href="/vis/doc/reference.html">经典文献</a></li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </div>
</header>
 
 
  <link rel="stylesheet" href="../../../../static/prettify-min.css">


  <div class="main-container clearfix">
  <div class="body-content tutorial-body-content"><div class="doc-nav">
  <p class="title">G2</p>
  <ul class="doc-nav-list">
    <li class="">
      <a href="/g2/doc/index.html" >快速上手</a>
    </li>
    <li class="">
      <div>
        <div class="menu-dir active">使用教程</div>
        <ul class="doc-sub-nav-list" style="">
          <li class="sub-title">基础教程</li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/start/index.html" >G2 图表的主要组成</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/start/chart.html" >图表对象配置（chart）</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/start/working-with-data.html" >data 数据</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/start/frame.html" >Frame 常见操作</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/start/scale.html" >度量</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/start/col-defs.html" >列定义操作</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/start/geom.html" >geom 几何标记</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/start/attr.html" >attr 图形属性</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/start/coord.html" >coord 坐标系</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/start/axis.html" >axis 坐标轴</a>
          </li>
          <li class="active">
            <a href="../../../../g2/doc/tutorial/start/legend.html" >legend 图例</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/start/tooltip.html" >tooltip 提示信息</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/start/guide.html" >guide 辅助标记</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/start/stat.html" >stat 统计变换</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/start/facet.html" >facet 分面</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/start/theme.html" >theme 图表样式</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/start/label.html" >label 文本标签</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/start/chart-event.html" >图表事件 event</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/start/action.html" >图表交互</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/start/changedata.html" >数据异步加载与动态更新</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/start/g2-plugin-slider.html" >数据滑动条插件使用</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/start/rc-g2.html" >在 react 中使用 G2</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/start/fqas.html" >常见问题</a>
          </li>
          <li class="sub-title">高级教程</li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/advance/index.html" >G2 图形语法简介</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/advance/data-flow.html" >G2 的数据处理流程</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/advance/data-type-and-scale.html" >数据类型与度量</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/advance/coord-detailed.html" >坐标系详解</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/advance/chart-type.html" >图表类型</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/advance/geom-and-adjust.html" >几何标记和数据调整</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/advance/custom-shape.html" >自定义 shape</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/advance/view.html" >多视图 view 绘制</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/advance/layout.html" >layout 布局</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/advance/draw-word-cloud.html" >使用 G2 绘制词云</a>
          </li>
          <li class="">
            <a href="../../../../g2/doc/tutorial/advance/animate.html" >自定义动画</a>
          </li>
        </ul>
      </div>
    </li>
    <li class="">
      <a href="/g2/demo/index.html" >图表示例</a>
    </li>
    <li class="">
      <div>
        <div class="menu-dir">API</div>
        <ul class="doc-sub-nav-list" style="display:none;">
          <li class="">
            <a href="../../../../g2/api/index.html" >G2</a>
          </li>
          <li class="">
            <a href="../../../../g2/api/chart.html" >Chart</a>
          </li>
          <li class="">
            <a href="../../../../g2/api/view.html" >View</a>
          </li>
          <li class="">
            <a href="../../../../g2/api/geom.html" >Geom</a>
          </li>
          <li class="">
            <a href="../../../../g2/api/scale.html" >Scale</a>
          </li>
          <li class="">
            <a href="../../../../g2/api/stat.html" >Stat</a>
          </li>
          <li class="">
            <a href="../../../../g2/api/frame.html" >Frame</a>
          </li>
          <li class="">
            <a href="../../../../g2/api/shape.html" >Shape</a>
          </li>
          <li class="">
            <a href="../../../../g2/api/animate.html" >Animate</a>
          </li>
          <li class="">
            <a href="../../../../g2/api/layout.html" >Layout</a>
          </li>
          <li class="">
            <a href="../../../../g2/api/global.html" >Global</a>
          </li>
          <li class="">
            <a href="../../../../g2/api/util.html" >Util</a>
          </li>
          <li class="">
            <a href="../../../../g2/api/canvas.html" >Canvas</a>
          </li>
          <li class="">
            <a href="../../../../g2/api/chart-options.html" >配置项支持</a>
          </li>
        </ul>
      </div>
    </li>
    <li class="">
      <a href="/g2/doc/history.html" >更新日志</a>
    </li>
  </ul>
</div>

<script type="text/javascript">
$(".menu-dir").on("click", function(e){
  var span = $(e.target);
  span.toggleClass("active");
  var ul = span.next();
  if (!span.hasClass('active')) {
    ul.slideUp(300);
  } else {
    ul.slideDown(300);
  }
});
</script>
<script src="https://a.alipayobjects.com/jquery/jquery/1.11.1/jquery.js"></script>
<script src="https://gw.alipayobjects.com/as/g/datavis/g2/2.3.13/index.js"></script>
    <div class="doc-content clearfix">
      <div class="doc-inner">
        <h2 id="简介">简介</h2><p>图例（legend）是图表的辅助元素，使用颜色、大小、形状区分不同的数据类型，用于图表中数据的筛选。G2 会根据设置图形属性映射以及数据的类型自动生成不同的图例。 </p>
<ul>
<li>shape, color, size 这三个图形属性如果判断接收的参数是数据源的字段时，会自动生成不同的图例；</li>
<li>shape 属性，会根据不同的 shape 类型生成图例；</li>
<li>color 属性, 会赋予不同的图例项不同的颜色来区分图形；</li>
<li>size 属性, 在图例上显示图形的大小。</li>
</ul>
<p>通过 <code>chart.legend([dim, ]false)</code> 可以关闭图例。</p>
<p><img src="https://zos.alipayobjects.com/skylark/9f146402-1e62-4029-b3b8-3d32029af1d6/attach/2378/eb826d75a0bb34cb/image.png" alt="image"></p>
<h2 id="如何配置图例">如何配置图例</h2><p>调用 <code>chart.legend()</code> 进行图例的配置，使用方法如下所示：</p>
<div class="highlight"><pre><code class="javascript">chart.legend({ 
  position: <span class="string">'bottom'</span>, <span class="comment">// 设置图例的显示位置</span>
  spacingX: <span class="number">20</span> <span class="comment">// 图例项之间的水平间距</span>
});

chart.legend(<span class="string">'cut'</span>, <span class="literal">false</span>); <span class="comment">// 不显示 cut 字段对应的图例</span>

chart.legend(<span class="string">'price'</span>, {
  title: <span class="literal">null</span> <span class="comment">// 不展示图例 title</span>
});

chart.legend(<span class="literal">false</span>); <span class="comment">//所有的图例都不显示</span></code></pre></div><h2 id="图例样式设置">图例样式设置</h2><table>
<thead>
<tr>
<th>属性名</th>
<th>解释</th>
<th>默认值 </th>
</tr>
</thead>
<tbody>
<tr>
<td>position</td>
<td>图例的显示位置，可配置值 &#39;top&#39;,&#39;left&#39;,&#39;right&#39;,&#39;bottom&#39; 。</td>
<td>&#39;right&#39;</td>
</tr>
<tr>
<td>title</td>
<td>用于图例标题的显示样式配置，如果值为 null 则不展示。</td>
<td>左右两侧图例默认展示标题，上下图例默认不展示标题 </td>
</tr>
<tr>
<td>back</td>
<td>用于图例背景色的配置</td>
<td>默认没有背景色 </td>
</tr>
<tr>
<td>dx</td>
<td>整个图例的水平偏移距离</td>
<td>-- </td>
</tr>
<tr>
<td>dy</td>
<td>整个图例的垂直偏移距离</td>
<td>-- </td>
</tr>
<tr>
<td>width</td>
<td>图例的整体宽度（用于连续图例）</td>
<td>20 </td>
</tr>
<tr>
<td>height</td>
<td>图例的整体高度（用于连续图例）</td>
<td>156</td>
</tr>
<tr>
<td>itemWrap</td>
<td>图例项过多时是否自动换行（用于分类图例）</td>
<td>false </td>
</tr>
<tr>
<td>marker</td>
<td>配置图例 marker 的显示样式，支持指定 <code>point</code> 几何标记支持的所有 shape(除去 &#39;rect&#39;)：&#39;circle&#39;, &#39;square&#39;, &#39;bowtie&#39;, &#39;diamond&#39;, &#39;hexagon&#39;, &#39;triangle&#39;, &#39;triangle-down&#39;, &#39;hollowCircle&#39;, &#39;hollowSquare&#39;, &#39;hollowBowtie&#39;, &#39;hollowDiamond&#39;, &#39;hollowHexagon&#39;, &#39;hollowTriangle&#39;, &#39;hollowTriangle-down&#39;, &#39;cross&#39;, &#39;tick&#39;, &#39;plus&#39;, &#39;hyphen&#39;, &#39;line&#39;</td>
<td>&#39;circle&#39;</td>
</tr>
</tbody>
</table>
<div id="legendMarker"></div>

<script>(function(){'use strict';

var data = [{ 'year': 'Year 1800', 'region': 'Africa', population: 107 }, { 'year': 'Year 1900', 'region': 'Africa', population: 133 }, { 'year': 'Year 2012', 'region': 'Africa', population: 1052 }, { 'year': 'Year 1800', 'region': 'America', population: 31 }, { 'year': 'Year 1900', 'region': 'America', population: 156 }, { 'year': 'Year 2012', 'region': 'America', population: 954 }, { 'year': 'Year 1800', 'region': 'Asia', population: 635 }, { 'year': 'Year 1900', 'region': 'Asia', population: 947 }, { 'year': 'Year 2012', 'region': 'Asia', population: 4250 }, { 'year': 'Year 1800', 'region': 'Europe', population: 203 }, { 'year': 'Year 1900', 'region': 'Europe', population: 408 }, { 'year': 'Year 2012', 'region': 'Europe', population: 740 }, { 'year': 'Year 1800', 'region': 'Oceania', population: 2 }, { 'year': 'Year 1900', 'region': 'Oceania', population: 6 }, { 'year': 'Year 2012', 'region': 'Oceania', population: 38 }];

var chart = new G2.Chart({
  id: 'legendMarker',
  width: 600,
  height: 350,
  plotCfg: {
    margin: [20, 90, 60, 80]
  }
});

chart.source(data);
chart.coord().transpose();
chart.axis('region', {
  title: null
});
chart.axis('population', {
  titleOffset: 25
});
chart.legend({
  title: null, // 不展示图例的标题
  marker: 'square' // 设置图例 marker 的显示样式
});
chart.intervalDodge().position('region*population').color('year').label('population');
chart.render();})()</script><div class="highlight"><pre><code class="javascript"><span class="keyword">var</span> data = [
  {<span class="string">'year'</span>: <span class="string">'Year 1800'</span>, <span class="string">'region'</span>: <span class="string">'Africa'</span>, population: <span class="number">107</span>},
  {<span class="string">'year'</span>: <span class="string">'Year 1900'</span>, <span class="string">'region'</span>: <span class="string">'Africa'</span>, population: <span class="number">133</span>},
  {<span class="string">'year'</span>: <span class="string">'Year 2012'</span>, <span class="string">'region'</span>: <span class="string">'Africa'</span>, population: <span class="number">1052</span>},
  {<span class="string">'year'</span>: <span class="string">'Year 1800'</span>, <span class="string">'region'</span>: <span class="string">'America'</span>, population: <span class="number">31</span>},
  {<span class="string">'year'</span>: <span class="string">'Year 1900'</span>, <span class="string">'region'</span>: <span class="string">'America'</span>, population: <span class="number">156</span>},
  {<span class="string">'year'</span>: <span class="string">'Year 2012'</span>, <span class="string">'region'</span>: <span class="string">'America'</span>, population: <span class="number">954</span>},
  {<span class="string">'year'</span>: <span class="string">'Year 1800'</span>, <span class="string">'region'</span>: <span class="string">'Asia'</span>, population: <span class="number">635</span>},
  {<span class="string">'year'</span>: <span class="string">'Year 1900'</span>, <span class="string">'region'</span>: <span class="string">'Asia'</span>, population: <span class="number">947</span>},
  {<span class="string">'year'</span>: <span class="string">'Year 2012'</span>, <span class="string">'region'</span>: <span class="string">'Asia'</span>, population: <span class="number">4250</span>},
  {<span class="string">'year'</span>: <span class="string">'Year 1800'</span>, <span class="string">'region'</span>: <span class="string">'Europe'</span>, population: <span class="number">203</span>},
  {<span class="string">'year'</span>: <span class="string">'Year 1900'</span>, <span class="string">'region'</span>: <span class="string">'Europe'</span>, population: <span class="number">408</span>},
  {<span class="string">'year'</span>: <span class="string">'Year 2012'</span>, <span class="string">'region'</span>: <span class="string">'Europe'</span>, population: <span class="number">740</span>},
  {<span class="string">'year'</span>: <span class="string">'Year 1800'</span>, <span class="string">'region'</span>: <span class="string">'Oceania'</span>, population: <span class="number">2</span>},
  {<span class="string">'year'</span>: <span class="string">'Year 1900'</span>, <span class="string">'region'</span>: <span class="string">'Oceania'</span>, population: <span class="number">6</span>},
  {<span class="string">'year'</span>: <span class="string">'Year 2012'</span>, <span class="string">'region'</span>: <span class="string">'Oceania'</span>, population: <span class="number">38</span>}
];

<span class="keyword">var</span> chart = <span class="keyword">new</span> G2.Chart({
  id: <span class="string">'legendMarker'</span>,
  width: <span class="number">600</span>,
  height: <span class="number">350</span>,
  plotCfg: {
    margin: [<span class="number">20</span>, <span class="number">90</span>, <span class="number">60</span>, <span class="number">80</span>]
  }
});

chart.source(data);
chart.coord().transpose();
chart.axis(<span class="string">'region'</span>, {
  title: <span class="literal">null</span>
});
chart.axis(<span class="string">'population'</span>, {
  titleOffset: <span class="number">25</span>
});
chart.legend({
  title: <span class="literal">null</span>, <span class="comment">// 不展示图例的标题</span>
  marker: <span class="string">'square'</span> <span class="comment">// 设置图例 marker 的显示样式</span>
});
chart.intervalDodge().position(<span class="string">'region*population'</span>).color(<span class="string">'year'</span>).label(<span class="string">'population'</span>);
chart.render();</code></pre></div><h2 id="图例项样式设置">图例项样式设置</h2><p><img src="https://zos.alipayobjects.com/skylark/734d10a6-3dbb-4712-8cfe-38378a76dc4d/attach/2378/63f40f7dc7406abc/image.png" alt="image"></p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>解释</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td>leaveChecked</td>
<td>(分类图例)是否保留一项不能取消勾选，默认为 true，即不能取消勾选</td>
<td>true</td>
</tr>
<tr>
<td>spacingX</td>
<td>用于调整各个图例项之间的水平间距</td>
<td>左右图例 10，上下图例 16</td>
</tr>
<tr>
<td>spacingY</td>
<td>用于调整各个图例项之间的垂直间距</td>
<td>左右图例 12，上下图例 10</td>
</tr>
<tr>
<td>wordSpaceing</td>
<td>marker和文本之间的距离</td>
<td>12</td>
</tr>
<tr>
<td>unChecked</td>
<td>未选中时marker的颜色</td>
<td>&#39;#CCC&#39;</td>
</tr>
<tr>
<td>word</td>
<td>图例项文本的样式配置</td>
<td>{fill: &#39;#3c3c3c&#39;}</td>
</tr>
</tbody>
</table>
<h2 id="图例的选择模式设置">图例的选择模式设置</h2><p>在 G2 中，图例分为两种：</p>
<ol>
<li>分类图例；</li>
<li>连续图例。</li>
</ol>
<p>对于分类图例的筛选，G2 提供了三种方式：</p>
<ol>
<li><code>multiple</code> 多选，默认配置；</li>
<li><code>single</code> 单选；</li>
<li><code>false</code> 禁用筛选。</li>
</ol>
<p>对于连续图例，只支持 <code>mode: false</code>(G2@2.3.0 及以上使用 <code>mode</code>，2.3.0 以下版本请使用 <code>selectedMode</code>) 关系筛选操作，默认开启。</p>
<p>通过如下代码即可进行配置：</p>
<div class="highlight"><pre><code class="javascript"><span class="comment">// 对所有图例进行配置</span>
chart.legend({
  <span class="comment">// G2@2.3.0 及以上使用 `mode`，2.3.0 以下版本请使用 `selectedMode`</span>
  mode: <span class="string">'single'</span> <span class="comment">// 选择单选模式</span>
});

<span class="comment">// 对某个图例进行配置</span>
chart.legend(<span class="string">'x'</span>, {
  <span class="comment">// G2@2.3.0 及以上使用 `mode`，2.3.0 以下版本请使用 `selectedMode`</span>
  mode: <span class="string">'false'</span> <span class="comment">// 禁用图例筛选</span>
});</code></pre></div><div id="c1"></div>
<script type="text/javascript">
var data = [{"部门":"部门0","小组":"组名0","完成人数":37,"未完成人数":9},{"部门":"部门0","小组":"组名2","完成人数":29,"未完成人数":10},{"部门":"部门0","小组":"组名8","完成人数":59,"未完成人数":14},{"部门":"部门0","小组":"组名9","完成人数":60,"未完成人数":8},{"部门":"部门0","小组":"组名10","完成人数":83,"未完成人数":14},{"部门":"部门0","小组":"组名12","完成人数":67,"未完成人数":21},{"部门":"部门0","小组":"组名14","完成人数":46,"未完成人数":18},{"部门":"部门0","小组":"组名17","完成人数":19,"未完成人数":27},{"部门":"部门0","小组":"组名19","完成人数":74,"未完成人数":17},{"部门":"部门1","小组":"组名15","完成人数":34,"未完成人数":19},{"部门":"部门1","小组":"组名20","完成人数":71,"未完成人数":25},{"部门":"部门1","小组":"组名26","完成人数":28,"未完成人数":23},{"部门":"部门1","小组":"组名29","完成人数":90,"未完成人数":24},{"部门":"部门2","小组":"组名7","完成人数":50,"未完成人数":5},{"部门":"部门2","小组":"组名11","完成人数":86,"未完成人数":26},{"部门":"部门2","小组":"组名13","完成人数":63,"未完成人数":16},{"部门":"部门2","小组":"组名27","完成人数":76,"未完成人数":2},{"部门":"部门2","小组":"组名28","完成人数":13,"未完成人数":28},{"部门":"部门3","小组":"组名1","完成人数":33,"未完成人数":16},{"部门":"部门3","小组":"组名3","完成人数":14,"未完成人数":1},{"部门":"部门3","小组":"组名4","完成人数":43,"未完成人数":25},{"部门":"部门3","小组":"组名16","完成人数":45,"未完成人数":13},{"部门":"部门3","小组":"组名18","完成人数":50,"未完成人数":21},{"部门":"部门3","小组":"组名22","完成人数":43,"未完成人数":7},{"部门":"部门3","小组":"组名23","完成人数":38,"未完成人数":6},{"部门":"部门3","小组":"组名24","完成人数":33,"未完成人数":24},{"部门":"部门3","小组":"组名25","完成人数":13,"未完成人数":27},{"部门":"部门4","小组":"组名5","完成人数":98,"未完成人数":4},{"部门":"部门4","小组":"组名6","完成人数":88,"未完成人数":12},{"部门":"部门4","小组":"组名21","完成人数":52,"未完成人数":9}];
  // 按照部门排序
  data.sort(function(obj1, obj2) {
    return obj1['部门'] > obj2['部门'] ? 1 : -1;
  });
  data.forEach(function(obj) {
    obj['完成人数'] *= -1; // 将完成人数转换成负数
  });
  var Frame = G2.Frame;
  var frame = new Frame(data);
  // 将'完成人数','未完成人数' 合并成一列，增加完成状态字段
  frame = Frame.combinColumns(frame, ['完成人数', '未完成人数'], '人数', '完成状态');
  var chart = new G2.Chart({
    id: 'c1',
    forceFit: true,
    height: 400,
    plotCfg: {
      margin: [5, 100, 80]
    }
  });
  chart.source(frame);
  chart.filter('部门', ['部门0']);
  chart.coord().transpose();
  // 关键代码：设置对应图例的选择模式
  chart.legend('部门', {
    mode: 'single', // G2@2.3.0 及以上使用 `mode`，2.3.0 以下版本请使用 `selectedMode`
  });
  // 关键代码：关闭对应图例的选择功能
  chart.legend('完成状态', {
    mode: false, // G2@2.3.0 及以上使用 `mode`，2.3.0 以下版本请使用 `selectedMode`
    position: 'bottom'
  })
  chart.axis('小组', {
    title: null
  });
  chart.axis('人数', {
    formatter: function(value) {
      value = parseInt(value);
      return Math.abs(value); // 将负数格式化成正数
    },
    title: null
  });
  chart.interval().position('小组*人数').color('部门').shape('完成状态', ['rect', 'hollowRect']).style({
    lineWidth: 2
  });
  chart.render();
</script>

<div class="clearfix"></div>

<h2 id="自定义-html-图例">自定义 html 图例</h2><p>如果默认生成的图例满足不了需求时，G2 还提供了一系列接口以支持用户自定义 html 图例。自定义图例主要调用方法如下：</p>
<ol>
<li>获取所有的几何标记对象 <code>chart.getAllGeoms()</code>;</li>
<li><p>获取每个几何标记所有 shape 的数据， <code>geom.getData()</code></p>
<p><code>geom.getData()</code> 返回的是一个数组，数组中每条记录会包含映射后的数据以及对应的原始数据记录，数据结构如下图所示：</p>
</li>
</ol>
<p>下面的实例就展示了如何使用这些接口结合 <code>plotclick</code> 事件实现一个自定义 html 图例来模拟默认生成的图例。</p>
<p><strong>完整代码</strong></p>
<div class="nico-insert-code"><!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>自定义图例</title>
  <script src="https://a.alipayobjects.com/jquery/jquery/1.11.1/jquery.js"></script>
  <script src="https://a.alipayobjects.com/g/datavis/g2/2.3.13/g2.js"></script>
  <style type="text/css">
    #legend .item{
      cursor:pointer;
    }
    #legend .item td{
      width: 25%;
      padding: 4px 10px;
    }
    #legend .dot{
      display: inline-block;
      width: 10px;height: 10px;
      border-radius: 50%;
      margin: 0 5px 0 0;
    }

    #legend {
      width: 300px;
      margin: 0 auto;
      text-align:left;
      border-collapse: collapse;
    }
  </style>
</head>
<body>
  <div id="mountNode">
    <table id="legend"></table>
  </div>

  <script>
    var data = [
      {name: '禁用', value: 10},
      {name: '限制', value: 20},
      {name: '正常', value: 40}
    ];
    var Util = G2.Util;
    var Stat = G2.Stat;
    var chart = new G2.Chart({
      id: 'mountNode',
      forceFit: true,
      height: 300
    });
    chart.source(data);
    chart.coord('theta', {
      inner: 0.8 // 设置饼图的大小
    });

    chart.legend(false); // 关掉自带图例
    chart.intervalStack().position(Stat.summary.percent('value')).color('name');
    chart.render();

    var geom = chart.getGeoms()[0]; // 获取所有的图形
    var items = geom.getData(); // 获取图形对应的数据
    var stash = {};

    for(var i=0, l=items.length; i< l;i++) {
      var item = items[i];
      var itemData = item._origin;
      var color = item.color;
      var name = itemData.name;
      var value = itemData.value;

      var trHtml = '<tr class="item" data-name="' + name + '">' + 
        '<td></td>' +
        '<td><span class="dot" style="background:' + color + ';"></span>' + name + '</td>' +
        '<td>' + value + '</td>' +
        '<td></td></tr>';
      var dom = $(trHtml).appendTo('#legend');
      stash[name] = {
        dotDom : dom.find('.dot'),
        item: item,
        color: color,
        name: name,
        isChecked: true
      }
    }

    $(".item").click(function() {
      var name = $(this).data('name');
      filter(name);
    });

    function filter(name){
      var obj = stash[name];
      var filterNames = [];

      obj.isChecked = obj.isChecked ? false : true;
      Util.each(stash, function(v){
        if(v.isChecked){
          v.dotDom.css('background', v.color);
          filterNames.push(v.name);
        }else{
          v.dotDom.css('background', '#999');
        }
      });
      chart.filter('name', filterNames)
      chart.repaint();
    }
  </script>
</body>
</html></div><div class="highlight"><pre><code class="xml"><span class="doctype">&lt;!DOCTYPE html&gt;</span>
<span class="tag">&lt;<span class="title">html</span>&gt;</span>
<span class="tag">&lt;<span class="title">head</span>&gt;</span>
  <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"utf-8"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">title</span>&gt;</span>自定义图例<span class="tag">&lt;/<span class="title">title</span>&gt;</span>
  <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"https://a.alipayobjects.com/jquery/jquery/1.11.1/jquery.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
  <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"https://a.alipayobjects.com/g/datavis/g2/2.3.13/g2.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
  <span class="tag">&lt;<span class="title">style</span> <span class="attribute">type</span>=<span class="value">"text/css"</span>&gt;</span><span class="css">
    <span class="id">#legend</span> <span class="class">.item</span><span class="rules">{
      <span class="rule"><span class="attribute">cursor</span>:<span class="value">pointer</span></span>;
    <span class="rule">}</span></span>
    <span class="id">#legend</span> <span class="class">.item</span> <span class="tag">td</span><span class="rules">{
      <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">25</span>%</span></span>;
      <span class="rule"><span class="attribute">padding</span>:<span class="value"> <span class="number">4</span>px <span class="number">10</span>px</span></span>;
    <span class="rule">}</span></span>
    <span class="id">#legend</span> <span class="class">.dot</span><span class="rules">{
      <span class="rule"><span class="attribute">display</span>:<span class="value"> inline-block</span></span>;
      <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">10</span>px</span></span>;<span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">10</span>px</span></span>;
      <span class="rule"><span class="attribute">border-radius</span>:<span class="value"> <span class="number">50</span>%</span></span>;
      <span class="rule"><span class="attribute">margin</span>:<span class="value"> <span class="number">0</span> <span class="number">5</span>px <span class="number">0</span> <span class="number">0</span></span></span>;
    <span class="rule">}</span></span>

    <span class="id">#legend</span> <span class="rules">{
      <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">300</span>px</span></span>;
      <span class="rule"><span class="attribute">margin</span>:<span class="value"> <span class="number">0</span> auto</span></span>;
      <span class="rule"><span class="attribute">text-align</span>:<span class="value">left</span></span>;
      <span class="rule"><span class="attribute">border-collapse</span>:<span class="value"> collapse</span></span>;
    <span class="rule">}</span></span>
  </span><span class="tag">&lt;/<span class="title">style</span>&gt;</span>
<span class="tag">&lt;/<span class="title">head</span>&gt;</span>
<span class="tag">&lt;<span class="title">body</span>&gt;</span>
  <span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"mountNode"</span>&gt;</span>
    <span class="tag">&lt;<span class="title">table</span> <span class="attribute">id</span>=<span class="value">"legend"</span>&gt;</span><span class="tag">&lt;/<span class="title">table</span>&gt;</span>
  <span class="tag">&lt;/<span class="title">div</span>&gt;</span>

  <span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript">
    <span class="keyword">var</span> data = [
      {name: <span class="string">'禁用'</span>, value: <span class="number">10</span>},
      {name: <span class="string">'限制'</span>, value: <span class="number">20</span>},
      {name: <span class="string">'正常'</span>, value: <span class="number">40</span>}
    ];
    <span class="keyword">var</span> Util = G2.Util;
    <span class="keyword">var</span> Stat = G2.Stat;
    <span class="keyword">var</span> chart = <span class="keyword">new</span> G2.Chart({
      id: <span class="string">'mountNode'</span>,
      forceFit: <span class="literal">true</span>,
      height: <span class="number">300</span>
    });
    chart.source(data);
    chart.coord(<span class="string">'theta'</span>, {
      inner: <span class="number">0.8</span> <span class="comment">// 设置饼图的大小</span>
    });

    chart.legend(<span class="literal">false</span>); <span class="comment">// 关掉自带图例</span>
    chart.intervalStack().position(Stat.summary.percent(<span class="string">'value'</span>)).color(<span class="string">'name'</span>);
    chart.render();

    <span class="keyword">var</span> geom = chart.getGeoms()[<span class="number">0</span>]; <span class="comment">// 获取所有的图形</span>
    <span class="keyword">var</span> items = geom.getData(); <span class="comment">// 获取图形对应的数据</span>
    <span class="keyword">var</span> stash = {};

    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>, l=items.length; i&lt; l;i++) {
      <span class="keyword">var</span> item = items[i];
      <span class="keyword">var</span> itemData = item._origin;
      <span class="keyword">var</span> color = item.color;
      <span class="keyword">var</span> name = itemData.name;
      <span class="keyword">var</span> value = itemData.value;

      <span class="keyword">var</span> trHtml = <span class="string">'&lt;tr class="item" data-name="'</span> + name + <span class="string">'"&gt;'</span> + 
        <span class="string">'&lt;td&gt;&lt;/td&gt;'</span> +
        <span class="string">'&lt;td&gt;&lt;span class="dot" style="background:'</span> + color + <span class="string">';"&gt;&lt;/span&gt;'</span> + name + <span class="string">'&lt;/td&gt;'</span> +
        <span class="string">'&lt;td&gt;'</span> + value + <span class="string">'&lt;/td&gt;'</span> +
        <span class="string">'&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;'</span>;
      <span class="keyword">var</span> dom = $(trHtml).appendTo(<span class="string">'#legend'</span>);
      stash[name] = {
        dotDom : dom.find(<span class="string">'.dot'</span>),
        item: item,
        color: color,
        name: name,
        isChecked: <span class="literal">true</span>
      }
    }

    $(<span class="string">".item"</span>).click(<span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
      <span class="keyword">var</span> name = $(<span class="keyword">this</span>).data(<span class="string">'name'</span>);
      filter(name);
    });

    <span class="function"><span class="keyword">function</span> <span class="title">filter</span><span class="params">(name)</span>{</span>
      <span class="keyword">var</span> obj = stash[name];
      <span class="keyword">var</span> filterNames = [];

      obj.isChecked = obj.isChecked ? <span class="literal">false</span> : <span class="literal">true</span>;
      Util.each(stash, <span class="function"><span class="keyword">function</span><span class="params">(v)</span>{</span>
        <span class="keyword">if</span>(v.isChecked){
          v.dotDom.css(<span class="string">'background'</span>, v.color);
          filterNames.push(v.name);
        }<span class="keyword">else</span>{
          v.dotDom.css(<span class="string">'background'</span>, <span class="string">'#999'</span>);
        }
      });
      chart.filter(<span class="string">'name'</span>, filterNames)
      chart.repaint();
    }
  </span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
<span class="tag">&lt;/<span class="title">body</span>&gt;</span>
<span class="tag">&lt;/<span class="title">html</span>&gt;</span></code></pre></div><h2 id="常见问题">常见问题</h2><ul>
<li>1.隐藏图例</li>
</ul>
<div class="highlight"><pre><code class="javascript">chart.legend(<span class="literal">false</span>); <span class="comment">// 隐藏全部图例</span>
chart.legend(<span class="string">'x'</span>, <span class="literal">false</span>); <span class="comment">// 只隐藏 x 维度对应的图例</span></code></pre></div><ul>
<li>2.更改图例位置</li>
</ul>
<div class="highlight"><pre><code class="javascript">chart.legend(<span class="string">'x'</span>, {
  position: <span class="string">'bottom'</span>
}); <span class="comment">// 只更改 x 维度对应的图例的显示位置</span></code></pre></div><ul>
<li>3.图例显示位置不够</li>
</ul>
<p>调整 plotCfg 属性中的 margin 值（margin 的介绍详见<a href="/g2/doc/tutorial/start/chart.html">图表对象配置之图表样式</a>）。</p>

      </div>
<div class="preNext clearfix">
  <a href="../../../../g2/doc/tutorial/start/coord.html" class="pull-left">
    <i class="iconfont icon-left"></i>
    coord 坐标系
  </a>
  <a href="../../../../g2/doc/tutorial/start/legend.html" class="pull-right">
    legend 图例
    <i class="iconfont icon-right"></i>
  </a>
</div>
    </div>
  </div>
  <script type="text/javascript" src="../../../../static/nav-menu.js"></script>
  <script src="../../../../static/prettify-min.js"></script>
  <script src="../../../../static/clipboard.min.js"></script>
  <script type="text/javascript">
    var CLS_PRETTY = 'prettyprint linenums';
    BUI.use('bui/common',function(BUI){
      var preEls =  $('pre');
      BUI.each(preEls,function(el){
        var node = $(el), innerText;
        node.addClass(CLS_PRETTY);
        innerText = node.html();
        var a = /^(\s+)/.exec(innerText);
        var regex;
        if(a){
          regex = new RegExp('('+a[0]+')(\\s*)','ig');
          innerText = innerText.replace(regex,'$2');
        }
          node.html(innerText);
      });
      if(window.prettyPrint){
        prettyPrint();
      }
    });

    $('.highlight').hover(function(e) {
      var target = $(e.target);
      if (target.attr('class') === 'prettyprint linenums') {
        target = target.parent();
      }
      $('<button id="codeCopyBtn">复制代码</button>').appendTo(target);
    }, function(e) {
      $('#codeCopyBtn').remove();
    });

    var clipboard = new Clipboard('#codeCopyBtn', {
      target: function() {
        return $('#codeCopyBtn').parent().find('pre')[0];
      }
    });
    clipboard.on('success', function(e) {
      e.clearSelection();

      $('#codeCopyBtn').text('复制成功!');
      setTimeout(function() {
        $('#codeCopyBtn').text('点击复制');
      }, 2000);
    });
    clipboard.on('error', function(e) {
      e.clearSelection();

      $('#codeCopyBtn').text('复制失败!');
      setTimeout(function() {
        $('#codeCopyBtn').text('点击复制');
      }, 2000);
    });
  </script>
  
  </div>
 
  <div style="display:none;">
<script src="https://s11.cnzz.com/z_stat.php?id=1259109662&web_id=1259109662" language="JavaScript"></script>
<script src="https://a.alipayobjects.com/g/component/tracert/1.0.0/index.js"></script>
</div>
</body>
</html>