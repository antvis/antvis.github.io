<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>G6 - 网图编辑器（变型2）</title>
  <meta name="keywords" content="G2, The Grammar of Graphics, 图形语法,图表绘制引擎,图表库,可视化,数据可视化,AntV,Data Visualization,visualization,visualisation, antd, ant, ant design, G6, 流程图, 关系图, 可视化规范, 地图, 河流图, 力导图, 网络图, UML图, 流图, 时序图, 图">
  <meta name="description" content="一套专业、简单、无限可能的可视化解决方案">
  <link rel="icon" href="https://zos.alipayobjects.com/rmsportal/oNtwPuEICFyCWUHztcOA.png" type="image/x-icon">
  <link rel="shortcut icon" href="https://zos.alipayobjects.com/rmsportal/oNtwPuEICFyCWUHztcOA.png" type="image/x-icon">
  <link rel="stylesheet" type="text/css" href="../../../static/style.css" />
  <link rel="stylesheet" type="text/css" href="../../../static/codemirror.css" />
  <link rel="stylesheet" type="text/css" href="../../../static/tipuesearch/tipuesearch.css" >
  <script src="../../../static/jquery.js"></script>
  <script src="../../../static/tipuesearch/tipuesearch_set.js"></script>
  <script src="../../../static/tipuesearch/tipuesearch.js"></script>
  <script src="https://g.alicdn.com/bui/??seajs/2.3.0/sea.js"></script>
  <script src="https://g.alicdn.com/bui/bui/1.1.17/config.js"></script>
  <script src="../../../static/script.js"></script>
<script src="https://gw.alipayobjects.com/os/antv/assets/g6/1.2.8/g6.min.js"></script>
</head>
<body class="demo-detail-page">
 

  <div class="main-container clearfix">

<div class="body-content demo-detail">

  <!-- demo 页面头部导航栏 -->
  <div class="demo-head">
    <div class="header clearfix">
      <a class="header-back" href="/g6/doc">
        <i class="iconfont icon-cross"></i>
      </a>
      <div class="header-crumb">
        <span class="chanel">G6</span> 图表示例
      </div>
    </div>
  </div>

  <!-- 左侧导航栏 -->
  <div class="doc-nav">
    <ul class="doc-nav-list">
      <li class="">
        <i class="iconfont">&#xe620;</i>
        <!-- <a href="#流图" id="demo流图" class="j_navItems">流图</a> -->
        <a href="/g6/demo/index.html#流图" id="demo流图" class="j_navItems">流图</a>
        <div class="hide">
        <ul class="demo-thumbnail-panel clearfix" id="J_demo流图">
          <li>
            <a href="../../../g6/demo/01-businessFlow/page-flow1.html">
              <img src="../../../static/images/g6/01-businessFlow/page-flow1.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/01-businessFlow/page-flow2.html">
              <img src="../../../static/images/g6/01-businessFlow/page-flow2.gif" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/01-businessFlow/saoma.html">
              <img src="../../../static/images/g6/01-businessFlow/saoma.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/01-businessFlow/sign-flow.html">
              <img src="../../../static/images/g6/01-businessFlow/sign-flow.gif" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/01-businessFlow/wuliu.html">
              <img src="../../../static/images/g6/01-businessFlow/wuliu.png" width="156px" />
            </a>
          </li>
        </ul>
        </div>
      </li>
      <li class="">
        <i class="iconfont">&#xe61f;</i>
        <!-- <a href="#树图" id="demo树图" class="j_navItems">树图</a> -->
        <a href="/g6/demo/index.html#树图" id="demo树图" class="j_navItems">树图</a>
        <div class="hide">
        <ul class="demo-thumbnail-panel clearfix" id="J_demo树图">
          <li>
            <a href="../../../g6/demo/02-tree/tree.html">
              <img src="../../../static/images/g6/02-tree/tree.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/02-tree/indented.html">
              <img src="../../../static/images/g6/02-tree/indented.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/02-tree/layered-tidy.html">
              <img src="../../../static/images/g6/02-tree/layered-tidy.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/02-tree/dendrogram.html">
              <img src="../../../static/images/g6/02-tree/dendrogram.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/02-tree/tree-layout.html">
              <img src="../../../static/images/g6/02-tree/tree-layout.png" width="156px" />
            </a>
          </li>
        </ul>
        </div>
      </li>
      <li class="">
        <i class="iconfont">&#xe6e5;</i>
        <!-- <a href="#网图" id="demo网图" class="j_navItems">网图</a> -->
        <a href="/g6/demo/index.html#网图" id="demo网图" class="j_navItems">网图</a>
        <div class="hide">
        <ul class="demo-thumbnail-panel clearfix" id="J_demo网图">
          <li>
            <a href="../../../g6/demo/03-net/languageInfluenceNetwork.html">
              <img src="../../../static/images/g6/03-net/languageInfluenceNetwork.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/03-net/force.html">
              <img src="../../../static/images/g6/03-net/force.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/03-net/systemNet.html">
              <img src="../../../static/images/g6/03-net/systemNet.png" width="156px" />
            </a>
          </li>
        </ul>
        </div>
      </li>
      <li class="">
        <i class="iconfont">&#xe6df</i>
        <!-- <a href="#编辑器" id="demo编辑器" class="j_navItems">编辑器</a> -->
        <a href="/g6/demo/index.html#编辑器" id="demo编辑器" class="j_navItems">编辑器</a>
        <div class="hide">
        <ul class="demo-thumbnail-panel clearfix" id="J_demo编辑器">
          <li>
            <a href="../../../g6/demo/04-editor/editor.html">
              <img src="../../../static/images/g6/04-editor/editor.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/04-editor/editor-extend1.html">
              <img src="../../../static/images/g6/04-editor/editor-extend1.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/04-editor/editor-extend2.html">
              <img src="../../../static/images/g6/04-editor/editor-extend2.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/04-editor/mind.html">
              <img src="../../../static/images/g6/04-editor/mind.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/04-editor/perventLink.html">
              <img src="../../../static/images/g6/04-editor/perventLink.gif" width="156px" />
            </a>
          </li>
        </ul>
        </div>
      </li>
      <li class="">
        <i class="iconfont">&#xe645</i>
        <!-- <a href="#画廊" id="demo画廊" class="j_navItems">画廊</a> -->
        <a href="/g6/demo/index.html#画廊" id="demo画廊" class="j_navItems">画廊</a>
        <div class="hide">
        <ul class="demo-thumbnail-panel clearfix" id="J_demo画廊">
          <li>
            <a href="../../../g6/demo/05-gallery/us-cpi.html">
              <img src="../../../static/images/g6/05-gallery/us-cpi.gif" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/05-gallery/iris-flower.html">
              <img src="../../../static/images/g6/05-gallery/iris-flower.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/05-gallery/dataBase.html">
              <img src="../../../static/images/g6/05-gallery/dataBase.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/05-gallery/sequence.html">
              <img src="../../../static/images/g6/05-gallery/sequence.png" width="156px" />
            </a>
          </li>
        </ul>
        </div>
      </li>
      <li class="">
        <i class="iconfont">&#xe6e9;</i>
        <!-- <a href="#其他" id="demo其他" class="j_navItems">其他</a> -->
        <a href="/g6/demo/index.html#其他" id="demo其他" class="j_navItems">其他</a>
        <div class="hide">
        <ul class="demo-thumbnail-panel clearfix" id="J_demo其他">
          <li>
            <a href="../../../g6/demo/06-other/html2canvas.html">
              <img src="../../../static/images/g6/06-other/html2canvas.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/anchor-attr.html">
              <img src="../../../static/images/g6/06-other/anchor-attr.gif" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/anchor-update.html">
              <img src="../../../static/images/g6/06-other/anchor-update.gif" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/crud.html">
              <img src="../../../static/images/g6/06-other/crud.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/custom-arrow.html">
              <img src="../../../static/images/g6/06-other/custom-arrow.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/editor.html">
              <img src="../../../static/images/g6/06-other/editor.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/event.html">
              <img src="../../../static/images/g6/06-other/event.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/fitView.html">
              <img src="../../../static/images/g6/06-other/fitView.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/flow-vis.html">
              <img src="../../../static/images/g6/06-other/flow-vis.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/g6ppt.html">
              <img src="../../../static/images/g6/06-other/g6ppt.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/anchor-type.html">
              <img src="../../../static/images/g6/06-other/anchor-type.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/htmlnode.html">
              <img src="../../../static/images/g6/06-other/htmlnode.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/mapping.html">
              <img src="../../../static/images/g6/06-other/mapping.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/mode.html">
              <img src="../../../static/images/g6/06-other/mode.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/node-get-fun.html">
              <img src="../../../static/images/g6/06-other/node-get-fun.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/saveAndread.html">
              <img src="../../../static/images/g6/06-other/saveAndread.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/source.html">
              <img src="../../../static/images/g6/06-other/source.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/tooltip-cfg.html">
              <img src="../../../static/images/g6/06-other/tooltip-cfg.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/tooltip-true.html">
              <img src="../../../static/images/g6/06-other/tooltip-true.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/tree-source.html">
              <img src="../../../static/images/g6/06-other/tree-source.png" width="156px" />
            </a>
          </li>
        </ul>
        </div>
      </li>
  </div>

  <div class="nav-mask fadeIn hide"></div>

  <script type="text/javascript">
  var clearTime;
  var navMask = $('div.nav-mask');
  $('a.j_navItems').click(function(e) {
    var target = $(e.target);
    target.parent().addClass('active').siblings().removeClass('active');
    navMask.addClass('hide');
  });

  $('a.j_navItems').mouseover(function(e) {
    clearTimeout(clearTime);
    var id = $(this).attr('id');
    var top = $(this).offset().top - $(this).height() / 2;
    navMask.removeClass('hide');
    navMask.html($('#J_' + id).prop("outerHTML"));
    navMask.css('top', top);
  }).mouseout(function() {
    clearTimeout(clearTime);

    clearTime = setTimeout(function() {
      if (!navMask.hasClass('hide')) {
        navMask.addClass('hide');
      }
    }, 250);
  });

  navMask.hover(function(e) {
    clearTimeout(clearTime);
    $(this).removeClass('hide');
    var thumbnailPanel = $(this).find('ul.demo-thumbnail-panel')[0];
    var id = thumbnailPanel.id;
    $('#' + id.substring(2)).parent().addClass('hover');
  }, function(e) {
    clearTimeout(clearTime);
    $(this).addClass('hide');
    var thumbnailPanel = $(this).find('ul.demo-thumbnail-panel')[0];
    var id = thumbnailPanel.id;
    $('#' + id.substring(2)).parent().removeClass('hover');
  });
  </script>
  <div id="widthHandler" class="handler"></div>

  <div class="doc-content demo-detail-doc">
    <div class="doc-inner">
      <div class="code-banner">
        <div class="tab-label actived">源码</div>
        <div class="code-operation">
          <button class="button" id="J_runCode">运行</button>
          <button class="button" id="J_copyCode">复制</button>
          <span id="J_copyStatus" style="display: none; color: #43CBC6; position: absolute; top: 35px; right: 10px; z-index: 20;"></span>
        </div>
      </div>
      <div class="code-panel">
        <div class="tab-content">
          <textarea id='code' name='code'>
   <!DOCTYPE html>
    <html>
      <head>
        <meta charset="utf-8">
        <title>网图编辑器（变型2）</title>
<script src="https://a.alipayobjects.com/jquery/jquery/1.11.1/jquery.js"></script>
<script src="https://gw.alipayobjects.com/os/antv/assets/g6/1.2.8/g6.min.js"></script>
      </head>
      <body>
          <div id="c1"></div>
 <script type="text/javascript">

// 第一步：注册节点
G6.registNode('customNode1', {
  draw: function(cfg, group) {
    var shape = group.addShape('rect', {
      attrs: {
        x: cfg.x-40,
        y: cfg.y-40,
        width: 80,
        height: 80,
        fill: '#fff',
        stroke: 'green'
      }
    });
    return shape;
  },
  getAnchorPoints: function(){
    return [
      [0, 0.25],
      [0, 0.5],
      [0, 0.75],
      [1, 0.25],
      [1, 0.5],
      [1, 0.75],
      [0.25, 0],
      [0.5, 0],
      [0.75, 0],
      [0.25, 1],
      [0.5, 1],
      [0.75, 1]
    ];
  }
}, 'rect');

G6.registNode('customNode2', {
  draw: function(cfg, group) {
    var shape = group.addShape('rect', {
      attrs: {
        x: cfg.x-40,
        y: cfg.y-40,
        width: 80,
        height: 80,
        fill: '#fff',
        stroke: 'red'
      }
    });
    return shape;
  }
}, 'customNode1');

// 第二步：设置按钮

$('#c1').append('<button id="addCustom1">自定义形1</button>');
$('#c1').append('<button id="addCustom2">自定义形2</button>');
$('#c1').append('<button id="drag">拖拽模式</button>');
$('#c1').append('<button id="edit">编辑模式</button>');
$('#c1').append('<button id="save">保存</button>');

var addCustom1 = $('#addCustom1');
var addCustom2 = $('#addCustom2');
var drag = $('#drag');
var edit = $('#edit');
var save = $('#save');
var data = {
    "nodes": [{
        "shape": "customNode1",
        "x": 370,
        "y": 30,
        "id": "27c5046d"
    }, {
        "shape": "customNode1",
        "x": 430,
        "y": 330,
        "id": "99d69b85"
    }, {
        "shape": "customNode2",
        "x": 650,
        "y": 220,
        "id": "f8cfdbd2"
    }, {
        "shape": "customNode1",
        "x": 80,
        "y": 210,
        "id": "3fabea06"
    }],
    "edges": [{
        "shape": "polyLineFlow",
        "source": "27c5046d",
        "target": "99d69b85",
        "id": "73b7ef7f",
        "controlPoints": [{
            "x": 410,
            "y": 110.5
        }, {
            "x": 470,
            "y": 329.5
        }],
        "sourceAnchor": 10,
        "targetAnchor": 7
    }, {
        "shape": "polyLineFlow",
        "source": "27c5046d",
        "target": "f8cfdbd2",
        "id": "cc306f85",
        "controlPoints": [{
            "x": 450.5,
            "y": 70
        }, {
            "x": 690,
            "y": 219.5
        }],
        "sourceAnchor": 4,
        "targetAnchor": 7
    }, {
        "shape": "polyLineFlow",
        "source": "27c5046d",
        "target": "f8cfdbd2",
        "id": "519d49a4",
        "controlPoints": [{
            "x": 410,
            "y": 29.5
        }, {
            "x": 730.5,
            "y": 239.75
        }],
        "sourceAnchor": 7,
        "targetAnchor": 3
    }, {
        "shape": "polyLineFlow",
        "source": "27c5046d",
        "target": "3fabea06",
        "id": "286f8ca2",
        "controlPoints": [{
            "x": 369.5,
            "y": 90.25
        }, {
            "x": 160.5,
            "y": 229.75
        }],
        "sourceAnchor": 2,
        "targetAnchor": 3
    }, {
        "shape": "polyLineFlow",
        "source": "27c5046d",
        "target": "3fabea06",
        "id": "f559fec8",
        "controlPoints": [{
            "x": 389.75,
            "y": 29.5
        }, {
            "x": 79.5,
            "y": 229.75
        }],
        "sourceAnchor": 6,
        "targetAnchor": 0
    }, {
        "shape": "polyLineFlow",
        "source": "27c5046d",
        "target": "3fabea06",
        "id": "4b0a2dcf",
        "controlPoints": [{
            "x": 389.75,
            "y": 110.5
        }, {
            "x": 160.5,
            "y": 270.25
        }],
        "sourceAnchor": 9,
        "targetAnchor": 5
    }, {
        "shape": "polyLineFlow",
        "source": "99d69b85",
        "target": "f8cfdbd2",
        "id": "c2514050",
        "controlPoints": [{
            "x": 490.25,
            "y": 410.5
        }, {
            "x": 669.75,
            "y": 300.5
        }],
        "sourceAnchor": 11,
        "targetAnchor": 9
    }]
};

// 第三步：配置画布
var net = new G6.Net({
  id: 'c1',      // 容器ID
  mode: 'edit',  // 编辑模式
  fitView: 'tl', // 自适应视口为左上
  height: 420    // 画布高
});

net.source(data.nodes, data.edges);

// 第四步：配置绑定事件
addCustom1.on('click', function(ev){
  net.beginAdd('node', {
    shape: 'customNode1'
  });
});

addCustom2.on('click', function(ev){
  net.beginAdd('node', {
    shape: 'customNode2'
  });
});

drag.on('click', function(ev) {
  net.changeMode('drag');
});

edit.on('click', function(ev) {
  net.changeMode('edit');
});

save.on('click', function(ev) {
  var saveData = net.save();
  var json = JSON.stringify(saveData, null, 2)
  console.log(saveData, json);
});

// 第五️步：编辑交互变形
var dragging = false;
net.removeBehaviour(['hoverNodeShowAnchor', 'dragEdgeEndHideAnchor', 'dragNodeEndHideAnchor']);
net.on('dragstart', function(ev){
  dragging = true;
});

net.on('dragend', function(ev){
  dragging = false;
});

// 进入锚点切换到曲线添加模式
net.on('mouseenter', function(ev) {
  var shape = ev.shape;
  if(shape && shape.hasClass('anchor-point') && !dragging) {
    net.beginAdd('edge', {
      shape: 'polyLineFlow'
    });
  }
});

// 离开锚点切换回编辑模式
net.on('mouseleave', function(ev) {
  var shape = ev.shape;
  if(shape && shape.hasClass('anchor-point') && !dragging) {
    net.changeMode('edit');
  }
});

net.on('afteritemrender', function(ev){
  var item = ev.item;
  if(item.get('type') === 'node'){
    net.showAnchor(item);
  }
});

// 第六步：渲染关系图
net.render();

</script>

      </body>
    </html>
          </textarea>
        </div>
      </div>
      <div class="chart-panel">
        <p class="title">网图编辑器（变型2）</p>
        <iframe id="preview" class="demo-chart "></iframe>
        <div class="demo-chart-intro">
          <p style="margin-top: 0;">
          该图向大家展示了如何在 G6 默认的交互上，稍加修改，快速搭建流程图编辑器变型
          </p>
        </div>
      </div>
    </div>
  </div>
</div>

<textarea class="hidden" id="reactCode">
  <!DOCTYPE html>
    <html>
      <head>
        <meta charset="utf-8">
        <title>网图编辑器（变型2）</title>
        <script src="https://unpkg.com/react@15/dist/react.min.js"></script>
        <script src="https://unpkg.com/react-dom@15/dist/react-dom.min.js"></script>
        <script src="https://a.alipayobjects.com/g/datavis/g2/2.3.13/g2.js"></script>
        <script src="https://unpkg.com/g2-react@1.2.0/dist/index.js"></script>
        <script src="https://cdn.bootcss.com/babel-core/5.8.38/browser.min.js"></script>
        <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
      </head>
      <body>
 <script type="text/babel">undefined
      </body>
    </html>
</textarea>
<script src="../../../static/codemirror-compressed.js"></script>
<script src="../../../static/clipboard.min.js"></script>
<script src="../../../static/demo-detail.js"></script>

  </div>
 
  <div style="display:none;">
<script src="https://s11.cnzz.com/z_stat.php?id=1259109662&web_id=1259109662" language="JavaScript"></script>
<script src="https://a.alipayobjects.com/g/component/tracert/1.0.0/index.js"></script>
</div>
</body>
</html>