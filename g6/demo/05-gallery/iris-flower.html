<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>G6 - 鸢尾花-关联图</title>
  <meta name="keywords" content="G2, The Grammar of Graphics, 图形语法,图表绘制引擎,图表库,可视化,数据可视化,AntV,Data Visualization,visualization,visualisation, antd, ant, ant design, G6, 流程图, 关系图, 可视化规范, 地图, 河流图, 力导图, 网络图, UML图, 流图, 时序图, 图">
  <meta name="description" content="一套专业、简单、无限可能的可视化解决方案">
  <link rel="icon" href="https://zos.alipayobjects.com/rmsportal/oNtwPuEICFyCWUHztcOA.png" type="image/x-icon">
  <link rel="shortcut icon" href="https://zos.alipayobjects.com/rmsportal/oNtwPuEICFyCWUHztcOA.png" type="image/x-icon">
  <link rel="stylesheet" type="text/css" href="../../../static/style.css" />
  <link rel="stylesheet" type="text/css" href="../../../static/codemirror.css" />
  <link rel="stylesheet" type="text/css" href="../../../static/tipuesearch/tipuesearch.css" >
  <script src="../../../static/jquery.js"></script>
  <script src="../../../static/tipuesearch/tipuesearch_set.js"></script>
  <script src="../../../static/tipuesearch/tipuesearch.js"></script>
  <script src="https://g.alicdn.com/bui/??seajs/2.3.0/sea.js"></script>
  <script src="https://g.alicdn.com/bui/bui/1.1.17/config.js"></script>
  <script src="../../../static/script.js"></script>
<script src="https://gw.alipayobjects.com/os/antv/assets/g6/1.2.8/g6.min.js"></script>
</head>
<body class="demo-detail-page">
 

  <div class="main-container clearfix">

<div class="body-content demo-detail">

  <!-- demo 页面头部导航栏 -->
  <div class="demo-head">
    <div class="header clearfix">
      <a class="header-back" href="/g6/doc">
        <i class="iconfont icon-cross"></i>
      </a>
      <div class="header-crumb">
        <span class="chanel">G6</span> 图表示例
      </div>
    </div>
  </div>

  <!-- 左侧导航栏 -->
  <div class="doc-nav">
    <ul class="doc-nav-list">
      <li class="">
        <i class="iconfont">&#xe620;</i>
        <!-- <a href="#流图" id="demo流图" class="j_navItems">流图</a> -->
        <a href="/g6/demo/index.html#流图" id="demo流图" class="j_navItems">流图</a>
        <div class="hide">
        <ul class="demo-thumbnail-panel clearfix" id="J_demo流图">
          <li>
            <a href="../../../g6/demo/01-businessFlow/page-flow1.html">
              <img src="../../../static/images/g6/01-businessFlow/page-flow1.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/01-businessFlow/page-flow2.html">
              <img src="../../../static/images/g6/01-businessFlow/page-flow2.gif" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/01-businessFlow/saoma.html">
              <img src="../../../static/images/g6/01-businessFlow/saoma.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/01-businessFlow/sign-flow.html">
              <img src="../../../static/images/g6/01-businessFlow/sign-flow.gif" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/01-businessFlow/wuliu.html">
              <img src="../../../static/images/g6/01-businessFlow/wuliu.png" width="156px" />
            </a>
          </li>
        </ul>
        </div>
      </li>
      <li class="">
        <i class="iconfont">&#xe61f;</i>
        <!-- <a href="#树图" id="demo树图" class="j_navItems">树图</a> -->
        <a href="/g6/demo/index.html#树图" id="demo树图" class="j_navItems">树图</a>
        <div class="hide">
        <ul class="demo-thumbnail-panel clearfix" id="J_demo树图">
          <li>
            <a href="../../../g6/demo/02-tree/tree.html">
              <img src="../../../static/images/g6/02-tree/tree.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/02-tree/indented.html">
              <img src="../../../static/images/g6/02-tree/indented.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/02-tree/layered-tidy.html">
              <img src="../../../static/images/g6/02-tree/layered-tidy.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/02-tree/dendrogram.html">
              <img src="../../../static/images/g6/02-tree/dendrogram.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/02-tree/tree-layout.html">
              <img src="../../../static/images/g6/02-tree/tree-layout.png" width="156px" />
            </a>
          </li>
        </ul>
        </div>
      </li>
      <li class="">
        <i class="iconfont">&#xe6e5;</i>
        <!-- <a href="#网图" id="demo网图" class="j_navItems">网图</a> -->
        <a href="/g6/demo/index.html#网图" id="demo网图" class="j_navItems">网图</a>
        <div class="hide">
        <ul class="demo-thumbnail-panel clearfix" id="J_demo网图">
          <li>
            <a href="../../../g6/demo/03-net/languageInfluenceNetwork.html">
              <img src="../../../static/images/g6/03-net/languageInfluenceNetwork.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/03-net/force.html">
              <img src="../../../static/images/g6/03-net/force.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/03-net/systemNet.html">
              <img src="../../../static/images/g6/03-net/systemNet.png" width="156px" />
            </a>
          </li>
        </ul>
        </div>
      </li>
      <li class="">
        <i class="iconfont">&#xe6df</i>
        <!-- <a href="#编辑器" id="demo编辑器" class="j_navItems">编辑器</a> -->
        <a href="/g6/demo/index.html#编辑器" id="demo编辑器" class="j_navItems">编辑器</a>
        <div class="hide">
        <ul class="demo-thumbnail-panel clearfix" id="J_demo编辑器">
          <li>
            <a href="../../../g6/demo/04-editor/editor.html">
              <img src="../../../static/images/g6/04-editor/editor.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/04-editor/editor-extend1.html">
              <img src="../../../static/images/g6/04-editor/editor-extend1.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/04-editor/editor-extend2.html">
              <img src="../../../static/images/g6/04-editor/editor-extend2.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/04-editor/mind.html">
              <img src="../../../static/images/g6/04-editor/mind.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/04-editor/perventLink.html">
              <img src="../../../static/images/g6/04-editor/perventLink.gif" width="156px" />
            </a>
          </li>
        </ul>
        </div>
      </li>
      <li class="">
        <i class="iconfont">&#xe645</i>
        <!-- <a href="#画廊" id="demo画廊" class="j_navItems">画廊</a> -->
        <a href="/g6/demo/index.html#画廊" id="demo画廊" class="j_navItems">画廊</a>
        <div class="hide">
        <ul class="demo-thumbnail-panel clearfix" id="J_demo画廊">
          <li>
            <a href="../../../g6/demo/05-gallery/us-cpi.html">
              <img src="../../../static/images/g6/05-gallery/us-cpi.gif" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/05-gallery/iris-flower.html">
              <img src="../../../static/images/g6/05-gallery/iris-flower.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/05-gallery/dataBase.html">
              <img src="../../../static/images/g6/05-gallery/dataBase.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/05-gallery/sequence.html">
              <img src="../../../static/images/g6/05-gallery/sequence.png" width="156px" />
            </a>
          </li>
        </ul>
        </div>
      </li>
      <li class="">
        <i class="iconfont">&#xe6e9;</i>
        <!-- <a href="#其他" id="demo其他" class="j_navItems">其他</a> -->
        <a href="/g6/demo/index.html#其他" id="demo其他" class="j_navItems">其他</a>
        <div class="hide">
        <ul class="demo-thumbnail-panel clearfix" id="J_demo其他">
          <li>
            <a href="../../../g6/demo/06-other/html2canvas.html">
              <img src="../../../static/images/g6/06-other/html2canvas.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/anchor-attr.html">
              <img src="../../../static/images/g6/06-other/anchor-attr.gif" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/anchor-update.html">
              <img src="../../../static/images/g6/06-other/anchor-update.gif" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/crud.html">
              <img src="../../../static/images/g6/06-other/crud.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/custom-arrow.html">
              <img src="../../../static/images/g6/06-other/custom-arrow.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/editor.html">
              <img src="../../../static/images/g6/06-other/editor.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/event.html">
              <img src="../../../static/images/g6/06-other/event.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/fitView.html">
              <img src="../../../static/images/g6/06-other/fitView.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/flow-vis.html">
              <img src="../../../static/images/g6/06-other/flow-vis.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/g6ppt.html">
              <img src="../../../static/images/g6/06-other/g6ppt.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/anchor-type.html">
              <img src="../../../static/images/g6/06-other/anchor-type.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/htmlnode.html">
              <img src="../../../static/images/g6/06-other/htmlnode.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/mapping.html">
              <img src="../../../static/images/g6/06-other/mapping.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/mode.html">
              <img src="../../../static/images/g6/06-other/mode.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/node-get-fun.html">
              <img src="../../../static/images/g6/06-other/node-get-fun.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/saveAndread.html">
              <img src="../../../static/images/g6/06-other/saveAndread.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/source.html">
              <img src="../../../static/images/g6/06-other/source.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/tooltip-cfg.html">
              <img src="../../../static/images/g6/06-other/tooltip-cfg.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/tooltip-true.html">
              <img src="../../../static/images/g6/06-other/tooltip-true.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/tree-source.html">
              <img src="../../../static/images/g6/06-other/tree-source.png" width="156px" />
            </a>
          </li>
        </ul>
        </div>
      </li>
  </div>

  <div class="nav-mask fadeIn hide"></div>

  <script type="text/javascript">
  var clearTime;
  var navMask = $('div.nav-mask');
  $('a.j_navItems').click(function(e) {
    var target = $(e.target);
    target.parent().addClass('active').siblings().removeClass('active');
    navMask.addClass('hide');
  });

  $('a.j_navItems').mouseover(function(e) {
    clearTimeout(clearTime);
    var id = $(this).attr('id');
    var top = $(this).offset().top - $(this).height() / 2;
    navMask.removeClass('hide');
    navMask.html($('#J_' + id).prop("outerHTML"));
    navMask.css('top', top);
  }).mouseout(function() {
    clearTimeout(clearTime);

    clearTime = setTimeout(function() {
      if (!navMask.hasClass('hide')) {
        navMask.addClass('hide');
      }
    }, 250);
  });

  navMask.hover(function(e) {
    clearTimeout(clearTime);
    $(this).removeClass('hide');
    var thumbnailPanel = $(this).find('ul.demo-thumbnail-panel')[0];
    var id = thumbnailPanel.id;
    $('#' + id.substring(2)).parent().addClass('hover');
  }, function(e) {
    clearTimeout(clearTime);
    $(this).addClass('hide');
    var thumbnailPanel = $(this).find('ul.demo-thumbnail-panel')[0];
    var id = thumbnailPanel.id;
    $('#' + id.substring(2)).parent().removeClass('hover');
  });
  </script>
  <div id="widthHandler" class="handler"></div>

  <div class="doc-content demo-detail-doc">
    <div class="doc-inner">
      <div class="code-banner">
        <div class="tab-label actived">源码</div>
        <div class="code-operation">
          <button class="button" id="J_runCode">运行</button>
          <button class="button" id="J_copyCode">复制</button>
          <span id="J_copyStatus" style="display: none; color: #43CBC6; position: absolute; top: 35px; right: 10px; z-index: 20;"></span>
        </div>
      </div>
      <div class="code-panel">
        <div class="tab-content">
          <textarea id='code' name='code'>
   <!DOCTYPE html>
    <html>
      <head>
        <meta charset="utf-8">
        <title>鸢尾花-关联图</title>
<script src="https://a.alipayobjects.com/jquery/jquery/1.11.1/jquery.js"></script>
<script src="https://gw.alipayobjects.com/os/antv/assets/g6/1.2.8/g6.min.js"></script>
      </head>
      <body>
          <div id="c1"></div>
 <style>
#legend{
  position: absolute;
  top: 0px;
  left: 0px;
}
#c1{
  position: relative;
}
</style>

<p><!-- d3.js --></p>
<script src="https://d3js.org/d3.v4.min.js"></script>
<!-- g2.js -->
<script src="https://a.alipayobjects.com/g/datavis/g2/2.3.13/g2.js"></script>

<script type="text/javascript">
$.getJSON('../../../static/data/Iris-flower.json',function(data){
  var Util = G6.Util;
  var Stat = G2.Stat;
  var colorMap = {
    all: '#333',
    setosa: '#64A051',
    versicolor: '#F065B4',
    virginica: '#732096',
    background: '#F9F9F9'
  };
  var width = 500;
  var height = 450;
  var edgeMarkerRadius = 4;
  var pack = d3.pack()
               .padding(0.1);
  var createChart = function  (dim) {
    var container =  Util.createDOM('<div></div>');
    var chart = new G2.Chart({
      container: container,
      width: 10,
      height: 10,
      animate: false,
      plotCfg: {
        margin: [2, 2, 2, 2]
      }
    });
    chart.legend(false);
    chart.axis(false);
    chart.coord('polar').transpose();
    chart.source(data);
    chart.intervalStack().position(Stat.summary.proportion(Stat.bin.rect(dim, 0.2)))
        .color('Species', function(val){
          var rst = 'red';
          Util.each(colorMap, function(v, k){
            if(val.toLowerCase().indexOf(k) !== -1){
              rst = v;
              return false;
            }
          });
          return rst;
        })
        .style({
          lineWidth: 1,
          fillOpacity: 1
        })
    return chart;
  };
  var honeycombLayout = function (center, nodes, gap){
    var cgap = [];
    var i;

    nodes[0].x = center.x;
    nodes[0].y = center.y;
    for (i = 0; i < nodes.length; i++) {
      nodes[i].radius
    }
  };
  var traverseTree = function(root, callback) {
    var children = root.children;
    Util.each(children, function(child) {
      callback(child, root);
      if (child.children) {
        TreeUtil.traverseTree(child, callback);
      }
    });
  };
  var sepalLengthChart = createChart('SepalLength'); // SepalLength SepalWidth PetalLength PetalWidth
  var sepalWidthChart = createChart('SepalWidth'); // SepalLength SepalWidth PetalLength PetalWidth
  var petalLengthChart = createChart('PetalLength'); // SepalLength SepalWidth PetalLength PetalWidth
  var petalWidthChart = createChart('PetalWidth'); // SepalLength SepalWidth PetalLength PetalWidth
  var data = {
    nodes: [{
      id: 'sepalLength',
      name: '花萼长度',
      x: 670,
      y: 230,
      chart: sepalLengthChart
    },{
      id: 'sepalWidth',
      name: '花萼宽度',
      x: 840,
      y: 140,
      chart: sepalWidthChart
    },{
      id: 'petalLength',
      name: '花瓣长度',
      x: 480,
      y: 280,
      chart: petalLengthChart
    },{
      id: 'petalWidth',
      name: '花瓣宽度',
      x: 570,
      y: 420,
      chart: petalWidthChart
    }],
    edges: [{
      source: 'sepalLength',
      target: 'sepalWidth',
      children: [
        {
          species: 'setosa',
          correlation: 0.74
        }
      ]
    },{
      source: 'sepalLength',
      target: 'petalWidth',
      children: [
        {
          species: 'all',
          correlation: 0.82
        }
      ]
    },{
      source: 'sepalLength',
      target: 'petalLength',
      children: [
        {
          species: 'all',
          correlation: 0.87
        },
        {
          species: 'versicolor',
          correlation: 0.75
        },
        {
          species: 'virginica',
          correlation: 0.86
        }
      ]
    },{
      source: 'petalWidth',
      target: 'petalLength',
      children: [
        {
          species: 'all',
          correlation: 0.96
        },
        {
          species: 'versicolor',
          correlation: 0.79
        }
      ]
    }]
  };
  var net = new G6.Net({
    id: 'c1',        // dom 容器 id
    fitView: 'lc',   // 自适应视口左中
    grid: null,
    height: height
  });

  G6.registNode('customNode', {
    getHtml: function(cfg){
      var model = cfg.model;
      var chart = model.chart;
      var dom = chart.get('container');
      var size = cfg.size;
      chart.changeSize(size[0], size[1]);
      return dom;
    },
    afterDraw: function(cfg, group){
      var model = cfg.model;
      var padding = [6, 4];
      group.addShape('text', {
        attrs: {
          x: cfg.x + cfg.size[0]/2 + padding[0],
          y: cfg.y + padding[1],
          textAlign: 'left',
          textBaseline: 'middle',
          fill: '#666',
          text: model.name
        }
      });
    }
  }, 'html');

  G6.registEdge('customEdge', {
    afterDraw: function(cfg, group, keyShape){
      var model = cfg.model;
      var children = model.children;
      var center = keyShape.getPoint(0.5);
      var markerGroup = group.addGroup();
      var maxcorrelationChild;
      var edgeColor;
      var root;
      root = d3.hierarchy(model)
               .sum(function(d) { return Math.pow(d.correlation, 4); })
               .sort(function(a, b) { return b.correlation - a.correlation; });
      maxcorrelationChild = root.children[0];
      pack(root);
      markerGroup.translate(- maxcorrelationChild.x, - maxcorrelationChild.y);
      markerGroup.scale(edgeMarkerRadius/maxcorrelationChild.r, edgeMarkerRadius/maxcorrelationChild.r);
      markerGroup.translate(maxcorrelationChild.x, maxcorrelationChild.y);
      markerGroup.translate(center.x - maxcorrelationChild.x, center.y - maxcorrelationChild.y);
      keyShape.attr('stroke', colorMap[maxcorrelationChild.data.species]);
      // 画背景圆
      markerGroup.addShape('circle', {
        attrs: {
          x: maxcorrelationChild.x,
          y: maxcorrelationChild.y,
          r: 1,
          fill: colorMap['background']
        }
      });
      // 画标记 Marker
      traverseTree(root, function(child){
        markerGroup.addShape('circle', {
          attrs: {
            x: child.x,
            y: child.y,
            r: child.r,
            fill: colorMap[child.data.species]
          }
        });
      });
    }
  }, 'line');

  net.node()
     .size([50, 50])
     .style({
       stroke: null,
       fill: null
     })
     .shape('customNode');
  net.edge()
     .size(2)
     .shape('customEdge');
  net.removeBehaviour(['wheelZoom']);
  net.source(data.nodes, data.edges);
  net.render();

  // 绘制图例
  var containerDom = $('#c1');
  containerDom.css('background', colorMap.background);
  // containerDom.css('width', width + 'px');
  containerDom.css('height', height + 'px');
  containerDom.css('position', 'relative');
  containerDom.append('<ul id="legend"><li style="color:'+colorMap.all+'">All</li><li style="color:'+colorMap.setosa+'">Setosa</li><li style="color:'+colorMap.versicolor+'">Versicolor</li><li style="color:'+colorMap.virginica+'">Virginica</li></ul>');
});

</script>

      </body>
    </html>
          </textarea>
        </div>
      </div>
      <div class="chart-panel">
        <p class="title">鸢尾花-关联图</p>
        <iframe id="preview" class="demo-chart "></iframe>
        <div class="demo-chart-intro">
          <p style="margin-top: 0;">
          该图展示了对鸢尾花数据集进行关联分析的过程中，如何可视化关联分析的结果。该示例用颜色映射的花的种类，连接线映射了关联度在 0.7 以上的关系。连线上点的大小表示关联度的强弱。每个节点所画的占比玉玦图，表示每个品种在该属性下，不同数值区间内的占比。由图可得出结论，花瓣长度和花瓣宽度，在所有品种下都有关联关系，并且各个品类间有明显的分层。所以这两个属性，适合用于做区分种类的关键指示器。该示例主要向大家展示了如何使用 html 节点巧妙的结合 G6 与 G2，从而呈现一份精彩的可视化作品。<a href="https://en.wikipedia.org/wiki/Iris_flower_data_set">数据来源</a>
          </p>
        </div>
      </div>
    </div>
  </div>
</div>

<textarea class="hidden" id="reactCode">
  <!DOCTYPE html>
    <html>
      <head>
        <meta charset="utf-8">
        <title>鸢尾花-关联图</title>
        <script src="https://unpkg.com/react@15/dist/react.min.js"></script>
        <script src="https://unpkg.com/react-dom@15/dist/react-dom.min.js"></script>
        <script src="https://a.alipayobjects.com/g/datavis/g2/2.3.13/g2.js"></script>
        <script src="https://unpkg.com/g2-react@1.2.0/dist/index.js"></script>
        <script src="https://cdn.bootcss.com/babel-core/5.8.38/browser.min.js"></script>
        <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
      </head>
      <body>
 <script type="text/babel">undefined
      </body>
    </html>
</textarea>
<script src="../../../static/codemirror-compressed.js"></script>
<script src="../../../static/clipboard.min.js"></script>
<script src="../../../static/demo-detail.js"></script>

  </div>
 
  <div style="display:none;">
<script src="https://s11.cnzz.com/z_stat.php?id=1259109662&web_id=1259109662" language="JavaScript"></script>
<script src="https://a.alipayobjects.com/g/component/tracert/1.0.0/index.js"></script>
</div>
</body>
</html>