<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>G6 - 美国 2010 CPI 数据</title>
  <meta name="keywords" content="G2, The Grammar of Graphics, 图形语法,图表绘制引擎,图表库,可视化,数据可视化,AntV,Data Visualization,visualization,visualisation, antd, ant, ant design, G6, 流程图, 关系图, 可视化规范, 地图, 河流图, 力导图, 网络图, UML图, 流图, 时序图, 图">
  <meta name="description" content="一套专业、简单、无限可能的可视化解决方案">
  <link rel="icon" href="https://zos.alipayobjects.com/rmsportal/oNtwPuEICFyCWUHztcOA.png" type="image/x-icon">
  <link rel="shortcut icon" href="https://zos.alipayobjects.com/rmsportal/oNtwPuEICFyCWUHztcOA.png" type="image/x-icon">
  <link rel="stylesheet" type="text/css" href="../../../static/style.css" />
  <link rel="stylesheet" type="text/css" href="../../../static/codemirror.css" />
  <link rel="stylesheet" type="text/css" href="../../../static/tipuesearch/tipuesearch.css" >
  <script src="../../../static/jquery.js"></script>
  <script src="../../../static/tipuesearch/tipuesearch_set.js"></script>
  <script src="../../../static/tipuesearch/tipuesearch.js"></script>
  <script src="https://g.alicdn.com/bui/??seajs/2.3.0/sea.js"></script>
  <script src="https://g.alicdn.com/bui/bui/1.1.17/config.js"></script>
  <script src="../../../static/script.js"></script>
<script src="https://gw.alipayobjects.com/as/g/datavis/g6/1.1.6/index.js"></script>
</head>
<body class="demo-detail-page">
 

  <div class="main-container clearfix">

<div class="body-content demo-detail">

  <!-- demo 页面头部导航栏 -->
  <div class="demo-head">
    <div class="header clearfix">
      <a class="header-back" href="/g6/doc">
        <i class="iconfont icon-cross"></i>
      </a>
      <div class="header-crumb">
        <span class="chanel">G6</span> 图表示例
      </div>
    </div>
  </div>

  <!-- 左侧导航栏 -->
  <div class="doc-nav">
    <ul class="doc-nav-list">
      <li class="">
        <i class="iconfont">&#xe620;</i>
        <!-- <a href="#流图" id="demo流图" class="j_navItems">流图</a> -->
        <a href="/g6/demo/index.html#流图" id="demo流图" class="j_navItems">流图</a>
        <div class="hide">
        <ul class="demo-thumbnail-panel clearfix" id="J_demo流图">
          <li>
            <a href="../../../g6/demo/01-businessFlow/page-flow1.html">
              <img src="../../../static/images/g6/01-businessFlow/page-flow1.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/01-businessFlow/page-flow2.html">
              <img src="../../../static/images/g6/01-businessFlow/page-flow2.gif" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/01-businessFlow/saoma.html">
              <img src="../../../static/images/g6/01-businessFlow/saoma.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/01-businessFlow/sign-flow.html">
              <img src="../../../static/images/g6/01-businessFlow/sign-flow.gif" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/01-businessFlow/wuliu.html">
              <img src="../../../static/images/g6/01-businessFlow/wuliu.png" width="156px" />
            </a>
          </li>
        </ul>
        </div>
      </li>
      <li class="">
        <i class="iconfont">&#xe61f;</i>
        <!-- <a href="#树图" id="demo树图" class="j_navItems">树图</a> -->
        <a href="/g6/demo/index.html#树图" id="demo树图" class="j_navItems">树图</a>
        <div class="hide">
        <ul class="demo-thumbnail-panel clearfix" id="J_demo树图">
          <li>
            <a href="../../../g6/demo/02-tree/tree.html">
              <img src="../../../static/images/g6/02-tree/tree.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/02-tree/indented.html">
              <img src="../../../static/images/g6/02-tree/indented.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/02-tree/layered-tidy.html">
              <img src="../../../static/images/g6/02-tree/layered-tidy.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/02-tree/dendrogram.html">
              <img src="../../../static/images/g6/02-tree/dendrogram.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/02-tree/tree-layout.html">
              <img src="../../../static/images/g6/02-tree/tree-layout.png" width="156px" />
            </a>
          </li>
        </ul>
        </div>
      </li>
      <li class="">
        <i class="iconfont">&#xe6e5;</i>
        <!-- <a href="#网图" id="demo网图" class="j_navItems">网图</a> -->
        <a href="/g6/demo/index.html#网图" id="demo网图" class="j_navItems">网图</a>
        <div class="hide">
        <ul class="demo-thumbnail-panel clearfix" id="J_demo网图">
          <li>
            <a href="../../../g6/demo/03-net/languageInfluenceNetwork.html">
              <img src="../../../static/images/g6/03-net/languageInfluenceNetwork.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/03-net/force.html">
              <img src="../../../static/images/g6/03-net/force.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/03-net/systemNet.html">
              <img src="../../../static/images/g6/03-net/systemNet.png" width="156px" />
            </a>
          </li>
        </ul>
        </div>
      </li>
      <li class="">
        <i class="iconfont">&#xe6df</i>
        <!-- <a href="#编辑器" id="demo编辑器" class="j_navItems">编辑器</a> -->
        <a href="/g6/demo/index.html#编辑器" id="demo编辑器" class="j_navItems">编辑器</a>
        <div class="hide">
        <ul class="demo-thumbnail-panel clearfix" id="J_demo编辑器">
          <li>
            <a href="../../../g6/demo/04-editor/editor.html">
              <img src="../../../static/images/g6/04-editor/editor.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/04-editor/editor-extend1.html">
              <img src="../../../static/images/g6/04-editor/editor-extend1.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/04-editor/editor-extend2.html">
              <img src="../../../static/images/g6/04-editor/editor-extend2.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/04-editor/mind.html">
              <img src="../../../static/images/g6/04-editor/mind.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/04-editor/perventLink.html">
              <img src="../../../static/images/g6/04-editor/perventLink.gif" width="156px" />
            </a>
          </li>
        </ul>
        </div>
      </li>
      <li class="">
        <i class="iconfont">&#xe645</i>
        <!-- <a href="#画廊" id="demo画廊" class="j_navItems">画廊</a> -->
        <a href="/g6/demo/index.html#画廊" id="demo画廊" class="j_navItems">画廊</a>
        <div class="hide">
        <ul class="demo-thumbnail-panel clearfix" id="J_demo画廊">
          <li>
            <a href="../../../g6/demo/05-gallery/us-cpi.html">
              <img src="../../../static/images/g6/05-gallery/us-cpi.gif" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/05-gallery/iris-flower.html">
              <img src="../../../static/images/g6/05-gallery/iris-flower.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/05-gallery/dataBase.html">
              <img src="../../../static/images/g6/05-gallery/dataBase.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/05-gallery/sequence.html">
              <img src="../../../static/images/g6/05-gallery/sequence.png" width="156px" />
            </a>
          </li>
        </ul>
        </div>
      </li>
      <li class="">
        <i class="iconfont">&#xe6e9;</i>
        <!-- <a href="#其他" id="demo其他" class="j_navItems">其他</a> -->
        <a href="/g6/demo/index.html#其他" id="demo其他" class="j_navItems">其他</a>
        <div class="hide">
        <ul class="demo-thumbnail-panel clearfix" id="J_demo其他">
          <li>
            <a href="../../../g6/demo/06-other/html2canvas.html">
              <img src="../../../static/images/g6/06-other/html2canvas.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/anchor-attr.html">
              <img src="../../../static/images/g6/06-other/anchor-attr.gif" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/anchor-update.html">
              <img src="../../../static/images/g6/06-other/anchor-update.gif" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/crud.html">
              <img src="../../../static/images/g6/06-other/crud.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/custom-arrow.html">
              <img src="../../../static/images/g6/06-other/custom-arrow.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/editor.html">
              <img src="../../../static/images/g6/06-other/editor.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/event.html">
              <img src="../../../static/images/g6/06-other/event.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/fitView.html">
              <img src="../../../static/images/g6/06-other/fitView.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/flow-vis.html">
              <img src="../../../static/images/g6/06-other/flow-vis.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/g6ppt.html">
              <img src="../../../static/images/g6/06-other/g6ppt.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/anchor-type.html">
              <img src="../../../static/images/g6/06-other/anchor-type.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/htmlnode.html">
              <img src="../../../static/images/g6/06-other/htmlnode.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/mapping.html">
              <img src="../../../static/images/g6/06-other/mapping.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/mode.html">
              <img src="../../../static/images/g6/06-other/mode.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/node-get-fun.html">
              <img src="../../../static/images/g6/06-other/node-get-fun.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/saveAndread.html">
              <img src="../../../static/images/g6/06-other/saveAndread.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/source.html">
              <img src="../../../static/images/g6/06-other/source.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/tooltip-cfg.html">
              <img src="../../../static/images/g6/06-other/tooltip-cfg.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/tooltip-true.html">
              <img src="../../../static/images/g6/06-other/tooltip-true.png" width="156px" />
            </a>
          </li>
          <li>
            <a href="../../../g6/demo/06-other/tree-source.html">
              <img src="../../../static/images/g6/06-other/tree-source.png" width="156px" />
            </a>
          </li>
        </ul>
        </div>
      </li>
  </div>

  <div class="nav-mask fadeIn hide"></div>

  <script type="text/javascript">
  var clearTime;
  var navMask = $('div.nav-mask');
  $('a.j_navItems').click(function(e) {
    var target = $(e.target);
    target.parent().addClass('active').siblings().removeClass('active');
    navMask.addClass('hide');
  });

  $('a.j_navItems').mouseover(function(e) {
    clearTimeout(clearTime);
    var id = $(this).attr('id');
    var top = $(this).offset().top - $(this).height() / 2;
    navMask.removeClass('hide');
    navMask.html($('#J_' + id).prop("outerHTML"));
    navMask.css('top', top);
  }).mouseout(function() {
    clearTimeout(clearTime);

    clearTime = setTimeout(function() {
      if (!navMask.hasClass('hide')) {
        navMask.addClass('hide');
      }
    }, 250);
  });

  navMask.hover(function(e) {
    clearTimeout(clearTime);
    $(this).removeClass('hide');
    var thumbnailPanel = $(this).find('ul.demo-thumbnail-panel')[0];
    var id = thumbnailPanel.id;
    $('#' + id.substring(2)).parent().addClass('hover');
  }, function(e) {
    clearTimeout(clearTime);
    $(this).addClass('hide');
    var thumbnailPanel = $(this).find('ul.demo-thumbnail-panel')[0];
    var id = thumbnailPanel.id;
    $('#' + id.substring(2)).parent().removeClass('hover');
  });
  </script>
  <div id="widthHandler" class="handler"></div>

  <div class="doc-content demo-detail-doc">
    <div class="doc-inner">
      <div class="code-banner">
        <div class="tab-label actived">源码</div>
        <div class="code-operation">
          <button class="button" id="J_runCode">运行</button>
          <button class="button" id="J_copyCode">复制</button>
          <span id="J_copyStatus" style="display: none; color: #43CBC6; position: absolute; top: 35px; right: 10px; z-index: 20;"></span>
        </div>
      </div>
      <div class="code-panel">
        <div class="tab-content">
          <textarea id='code' name='code'>
   <!DOCTYPE html>
    <html>
      <head>
        <meta charset="utf-8">
        <title>美国 2010 CPI 数据</title>
<script src="https://a.alipayobjects.com/jquery/jquery/1.11.1/jquery.js"></script>
<script src="https://gw.alipayobjects.com/as/g/datavis/g6/1.1.6/index.js"></script>
      </head>
      <body>
          <div id="c1"></div>
 <style>
.legend{
  position: absolute;
  z-index: 4;
}
.size-legend circle{
  fill: #0078E6
}
#c1{
  position: relative;
}
</style>

<p><!-- d3.js --></p>
<script src="https://d3js.org/d3.v4.min.js"></script>
<!-- d3-legend.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.24.0/d3-legend.min.js"></script>

<script type="text/javascript">
$('#c1').append('<svg id="color-legend-container" class="legend"></svg>');
$('#c1').append('<svg id="size-legend-container" class="legend"></svg>');
$.getJSON('../../../static/data/us-cpi.json',function(data){
  var Util = G6.Util;
  var canvasHeight = 450;
  var graphCenterX = 250;
  var graphCenterY = canvasHeight/2;

  // 工具方法
  var formatterPersent = function(percent, digit){
    return percent.toFixed(digit) + ' %';
  };

  // 生成度量
  var trainScale = function(dim, scale){
    var max = -Infinity;
    var min = Infinity;
    data.nodes.map(function(node){
      if(node[dim] > max){
        max = node[dim];
      }
      if(node[dim] < min){
        min = node[dim];
      }
    });
    scale.domain([min, max]);
  };
  var colors = ['#007AE7', '#40BCD2', '#81D6C3', '#C1E4BC', '#FFDD9B', '#FEAC4C', '#FF7C01', '#C4201D'];
  var sizeScale = d3.scalePow().range([4, 20]).exponent(1/2);
  var colorScale = d3.scaleSequential(d3.interpolateRgbBasis(colors));
  trainScale('weight', sizeScale);
  trainScale('percentChange', colorScale);

  // 生成图
  var net = new G6.Net({
    id: 'c1',               // 容器ID
    height: canvasHeight,   // 画布高
    mode: 'analysis'
  });
  net.tooltip(true);
  net.node()
    .size(function(model){
      return sizeScale(model.weight)*2.2;
    })
    .color(function(model){
      return colorScale(model.percentChange);
    })
    .shape('circle')
    .style({
      stroke: '#666',
      strokeOpacity: 0.5,
      lineWidth: 1,
      fillOpacity: 1
    })
    .tooltip(function(model){
    return [
      ['类目', model.id],
      ['比重', formatterPersent(model.weight, 2)],
      ['波动', formatterPersent(model.percentChange, 2)]
    ]
  });
  net.source(data.nodes, data.edges);
  net.removeBehaviour(['dragCanvas', 'dragHideEdges', 'dragHideTexts']);
  net.addBehaviour(['dragBlank']);
  net.render();
  net.zoomAt(graphCenterX, graphCenterY, 0.5);

  // 生成布局
  var layoutNodes = data.nodes;
  var layoutEdges = Util.clone(data.edges);
  var ticked = function(){
    net.updateNodesPosition();
  };
  var forceStrength = -180;
  var simulation = d3.forceSimulation(layoutNodes)
  .force("link", d3.forceLink(layoutEdges).distance(20).strength(1).id(function(model) {
    return model.id;
  }))
  .force("charge", d3.forceManyBody().strength(forceStrength))
  .force("center", d3.forceCenter(graphCenterX, graphCenterY-20))
  .force("x", d3.forceX())
  .force("y", d3.forceY())
  .force('collide', d3.forceCollide(function(model){
    return sizeScale(model.weight)*2.2;
  }))
  .on("tick", ticked);

  // 生成颜色图例
  var svg = d3.select('#color-legend-container');
  svg.style('top', '270px');
  svg.style('left', '460px');
  svg.style('width', '170px');
  svg.style('height', '200px');
  svg.style('transform', 'scale(0.65, 0.65)');
  svg.append("g")
    .attr("class", "color-legend")
    .attr("transform", "translate(20,20)");

  var colorLegend = d3.legendColor()
    .cells(colors.length)
    .title('CPI')
    .labelFormat(function(v){
      return formatterPersent(v, 0);
    })
    .scale(colorScale);
  svg.select(".color-legend")
    .call(colorLegend);

  // 生成大小图例
  var svg = d3.select('#size-legend-container');
  svg.style('top', '80px');
  svg.style('left', '460px');
  svg.style('width', '170px');
  svg.style('height', '240px');
  svg.style('transform', 'scale(0.65, 0.65)');
  svg.append("g")
    .attr("class", "size-legend")
    .attr("transform", "translate(20,20)");

  var sizeLegend = d3.legendSize()
    .title('占总经济权重')
    .shape('circle')
    .shapePadding(7)
    .scale(sizeScale);
  svg.select(".size-legend")
    .call(sizeLegend);
});
</script>

      </body>
    </html>
          </textarea>
        </div>
      </div>
      <div class="chart-panel">
        <p class="title">美国 2010 CPI 数据</p>
        <iframe id="preview" class="demo-chart "></iframe>
        <div class="demo-chart-intro">
          <p style="margin-top: 0;">
          该图展示了 2012 年度，美国全国各商品CPI指数。节点大小映射了该品类交易额度占总交易额的比重，颜色映射了该品类CPI的指数。该示例主要向大家展示了如何使用 G6 结合优秀的第三方力导布局算法，高效的绘制动态力导图。
          </p>
        </div>
      </div>
    </div>
  </div>
</div>

<textarea class="hidden" id="reactCode">
  <!DOCTYPE html>
    <html>
      <head>
        <meta charset="utf-8">
        <title>美国 2010 CPI 数据</title>
        <script src="https://unpkg.com/react@15/dist/react.min.js"></script>
        <script src="https://unpkg.com/react-dom@15/dist/react-dom.min.js"></script>
        <script src="https://a.alipayobjects.com/g/datavis/g2/2.3.13/g2.js"></script>
        <script src="https://unpkg.com/g2-react@1.2.0/dist/index.js"></script>
        <script src="https://cdn.bootcss.com/babel-core/5.8.38/browser.min.js"></script>
        <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
      </head>
      <body>
 <script type="text/babel">undefined
      </body>
    </html>
</textarea>
<script src="../../../static/codemirror-compressed.js"></script>
<script src="../../../static/clipboard.min.js"></script>
<script src="../../../static/demo-detail.js"></script>

  </div>
 
  <div style="display:none;">
<script src="https://s11.cnzz.com/z_stat.php?id=1259109662&web_id=1259109662" language="JavaScript"></script>
<script src="https://a.alipayobjects.com/g/component/tracert/1.0.0/index.js"></script>
</div>
</body>
</html>